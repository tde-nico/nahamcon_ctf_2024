from Crypto.Cipher import Salsa20
import base64


glob_key = "24a0b299984ee8da7aae14b7163e2e63"

def decrypt1(bro):
	a = ""
	for s in range(0, len(bro), 2):
		b = str(bro[s:s+2] + "==")
		a += str(base64.b64decode(b).decode("ascii"))
	return a


def decrypt2(a1, a2):
	result = ""
	for character in a1:
		result += chr((ord(character) - ord("a") + a2) % 26 + ord("a"))
	else:
		return result


def decrypt3(s1, key):
	msg_nonce = s1[:8]
	ciphertext = s1[8:]
	cipher = Salsa20.new(key=(key.encode("utf-8")), nonce=msg_nonce)
	return cipher.decrypt(ciphertext).decode("utf-8")


def deobfuscate():
	part1 = decrypt1("ZgbAYQZwewMAOAZQOQYwYwNQYgMA")
	part2 = decrypt2("fwvcttjsfvrshwsg", 17)
	part3 = decrypt3(b'\x97p#2\x1abw\x0f\x9a\xd1Z\x04b\x93\xa1h8]\xab\xa3\x9e7\xc9\xe8\x9b', "25dbd4f362f7d0e64b24ab231728a1fc")
	key = part1 + part2 + part3
	return key


if __name__ == "__main__":
	print(deobfuscate())

# flag{08e9cc5b0wnmtkkajwmijynjx3a415bd9a8024930}
